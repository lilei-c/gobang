var gt=Object.defineProperty;var bt=(i,t,s)=>t in i?gt(i,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[t]=s;var H=(i,t,s)=>(bt(i,typeof t!="symbol"?t+"":t,s),s);import{j as st,r as I,a as T,c as pt}from"./vendor-cd7d93c1.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))e(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&e(l)}).observe(document,{childList:!0,subtree:!0});function s(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerpolicy&&(o.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?o.credentials="include":n.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function e(n){if(n.ep)return;n.ep=!0;const o=s(n);fetch(n.href,o)}})();const _=st.Fragment,m=st.jsx,W=st.jsxs,G=0,w=1,F=2,tt=3,p=15,X=p/2>>0,Z=(i,t=void 0,s=!1)=>(typeof t=="object"&&!s&&console.error(`
    val 为"引用类型"时, 请明确传递参数 yesHereIsObjectVal
    另外: 对于"引用类型", arrayN 使用 structuredClone 处理 val, 防止多个变量指向相同引用`),Array(i).fill().map(()=>structuredClone(t))),qt=(i,t=20)=>{let s=+new Date;return(...e)=>{+new Date-s>t&&i(...e),s=+new Date}},St=i=>t=>Array(t-i).fill(null).map((s,e)=>i+e),K=St(0),mt={l1:2**0,d2:2**3,l2:2**6,l2x2:2**7,d3:2**9,l3:2**12,d4:2**14,l4:2**16,l5:2**18},O=i=>({l1:i&7,d2:(i&56)>>3,l2:(i&960)>>6,d3:(i&7680)>>9,l3:(i&12288)>>12,d4:(i&49152)>>14,l4:(i&196608)>>16,l5:(i&786432)>>18}),f={l1:10,d2:10,d3:200,l2:150,l2x2:300,l3:200,d4:2e3,l4:5e3,l5:1e4,win:1e5},et=i=>{const{l5:t,l4:s,d4:e,l3:n,d3:o,l2:l,d2:c,l1:r}=i;let d=0;return t&&(d+=f.l5*t),s&&(d+=f.l4*s),e&&(d+=f.d4*e),n&&(d+=f.l3*n),o&&(d+=f.d3*o),l&&(d+=f.l2*l),c&&(d+=f.d2*c),r&&(d+=f.l1*r),d};console.warn("todo: 测试 countLine 是否正确");const kt=(i,t,s)=>e=>{let n=1;for(let o=0;o<e.length;o++){const l=e[o];if(o<4)n<<=1,l===i?n+=1:(l===t||l===s)&&(n=1);else if(o===4)n<<=1,n+=1;else{if(l===t||l===s)break;n<<=1,l===i&&(n+=1)}}return n},wt=i=>{let t=[],s=2**(i+1);for(;s-- >0;)t.push("0b"+s.toString(2));return t},j=wt(11),Mt=i=>/010/.test(i)&&i.length>5,vt=i=>/10{0,1}1/.test(i)&&i.length>=5,Et=i=>[/000110/,/001100/,/011000/,/001010/,/010100/].some(t=>t.test(i)),Ct=i=>/0101010/.test(i),Lt=i=>[/111/,/1011/,/1101/,/11001/,/10011/,/10101/].some(t=>t.test(i))&&i.length>=5,Ft=i=>[/010110/,/011010/,/01110/,/1010101/].some(t=>t.test(i)),yt=i=>[/11110/,/01111/,/11011/,/11101/,/10111/].some(t=>t.test(i)),Pt=i=>[/011110/,/1011101/,/11011011/,/111010111/].some(t=>t.test(i)),xt=i=>/1{5}/.test(i),D={};j.forEach(i=>D[i]=null);const B=[],{l5:Dt,l4:Nt,d4:zt,l3:Bt,d3:Rt,l2:Ut,l2x2:Qt,d2:Wt,l1:jt}=mt;j.forEach(i=>Mt(i.slice(3))&&(D[i]="l1")&&(B[+i]=jt));j.forEach(i=>vt(i.slice(3))&&(D[i]="d2")&&(B[+i]=Wt));j.forEach(i=>Et(i.slice(3))&&(D[i]="l2")&&(B[+i]=Ut));j.forEach(i=>Lt(i.slice(3))&&(D[i]="d3")&&(B[+i]=Rt));j.forEach(i=>Ct(i.slice(3))&&(D[i]="l2x2")&&(B[+i]=Qt));j.forEach(i=>Ft(i.slice(3))&&(D[i]="l3")&&(B[+i]=Bt));j.forEach(i=>yt(i.slice(3))&&(D[i]="d4")&&(B[+i]=zt));j.forEach(i=>Pt(i.slice(3))&&(D[i]="l4")&&(B[+i]=Nt));j.forEach(i=>xt(i.slice(3))&&(D[i]="l5")&&(B[+i]=Dt));console.log("未构成棋型的组合, 这一部分已经验证",Object.keys(D).filter(i=>!D[i]).map(i=>i.slice(3)));console.warn("todo: 验证以下棋型是否正确");Object.keys(f).forEach(i=>{console.log(i,Object.keys(D).filter(t=>D[t]===i).map(t=>t.slice(3)))});console.log({allModes:j,serialPointMode:B});class Vt{constructor({size:t}){this.max=Z(t).map(e=>Z(t).map(()=>I.int(0,1073741824))),this.min=Z(t).map(e=>Z(t).map(()=>I.int(0,1073741824))),this.code=I.int(0,1073741824),this.hash={}}go(t,s,e){this.code^=e?this.max[t][s]:this.min[t][s]}get(){return this.hash[this.code]}set(t){this.hash[this.code]=t}resetHash(){this.hash={}}}const{l1:it,d2:nt,l2:ot,l2x2:lt,d3:rt,l3:at,d4:ht,l4:ct,l5:dt}=mt;function Tt(i,t){const s=this.winner;if(s===w)return f.win;if(s===F)return-f.win;if(i)return 0;let e=0,n=0,o=0,l=0,c=0,r=0,d=0,g=0,a=0,b=0,q=0,A=0,v=0,S=0,u=0,M=0;const C=(h,k)=>{if(k<34)return;const N=B[k];if(N)if(h===w)switch(N){case it:return g++;case nt:return d++;case ot:return r++;case lt:return r+=2;case rt:return c++;case at:return l++;case ht:return o++;case ct:return n++;case dt:return e++;default:return console.error("error")}else switch(N){case it:return M++;case nt:return u++;case ot:return S++;case lt:return S+=2;case rt:return v++;case at:return A++;case ht:return q++;case ct:return b++;case dt:return a++;default:return console.error("error")}},P=(h,k,N)=>{let x=1,U=0,V=!1;for(let J=0;J<15;J++){const $=N&3;if(N>>=2,$===k||$===tt){C(h,x),x=1,V=!0;continue}else if($===G)if(U===0)U++,x<<=1;else{x<<=1,(N&12)===G&&J!==14&&(x<<=1),C(h,x),x=4,(N&12)===G&&J!==14&&(x<<=1),U=0,V=!0;continue}else U=0,V=!1,x<<=1,x+=1}V||C(h,x)};for(let h=0;h<this.node0.length;h++)P(w,F,this.node0[h]);for(let h=0;h<this.node1.length;h++)P(w,F,this.node1[h]);for(let h=0;h<this.node2.length;h++)P(w,F,this.node2[h]);for(let h=0;h<this.node3.length;h++)P(w,F,this.node3[h]);for(let h=0;h<this.node0.length;h++)P(F,w,this.node0[h]);for(let h=0;h<this.node1.length;h++)P(F,w,this.node1[h]);for(let h=0;h<this.node2.length;h++)P(F,w,this.node2[h]);for(let h=0;h<this.node3.length;h++)P(F,w,this.node3[h]);t&&(console.log({maxL1:g,maxD2:d,maxL2:r,maxD3:c,maxL3:l,maxD4:o,maxL4:n,maxL5:e}),console.log({minL1:M,minD2:u,minL2:S,minD3:v,minL3:A,minD4:q,minL4:b,minL5:a}));let Y=0,y=0;if((this.seekDepth&1)===0){if(n||o)return f.l5;if(b||q>2||A>2||A&q)return-f.l5;l&&!b&&!q&&(Y+=f.l4)}else{if(b||q)return-f.l5;if(n)return f.l5;if(o>2||l>2||l&o)return-f.l5;A&&!n&&!o&&(y+=f.l4)}return Y=f.l5*e+f.l4*n+f.d4*o+f.l3*l+f.d3*c+f.l2*r+f.d2*d+f.l1*d,y=f.l5*a+f.l4*b+f.d4*q+f.l3*A+f.d3*v+f.l2*S+f.d2*u+f.l1*u,Y*this.attackFactor-y*this.defenseFactor}function Zt(i,t,s){let e=[],n=[],o=[],l=[],c=[],r=[],d=[],g=[],a=[],b=[],q=[],A=[];for(let S=0;S<i.length;S++){const u=i[S],[M,C]=u;let P=0,Y=0,y=O(this.maxPointsScore[M][C][0]);{const L=O(this.maxPointsScore[M][C][1]),h=O(this.maxPointsScore[M][C][2]),k=O(this.maxPointsScore[M][C][3]);y.l5+=L.l5+h.l5+k.l5,y.l4+=L.l4+h.l4+k.l4,y.d4+=L.d4+h.d4+k.d4,y.l3+=L.l3+h.l3+k.l3,y.d3+=L.d3+h.d3+k.d3,y.l2+=L.l2+h.l2+k.l2,y.d2+=L.d2+h.d2+k.d2,y.l1+=L.l1+h.l1+k.l1;const{l5:N,l4:x,d4:U,l3:V}=y;N?e.push(u):x?o.push(u):(U>1&&g.push(u),V&&U&&a.push(u),V>1&&q.push(u),V&&d.push(u),U&&c.push(u)),P=et(y)}let R=O(this.minPointsScore[M][C][0]);{const L=O(this.minPointsScore[M][C][1]),h=O(this.minPointsScore[M][C][2]),k=O(this.minPointsScore[M][C][3]);R.l5+=L.l5+h.l5+k.l5,R.l4+=L.l4+h.l4+k.l4,R.d4+=L.d4+h.d4+k.d4,R.l3+=L.l3+h.l3+k.l3,R.d3+=L.d3+h.d3+k.d3,R.l2+=L.l2+h.l2+k.l2,R.d2+=L.d2+h.d2+k.d2,R.l1+=L.l1+h.l1+k.l1;const{l5:N,l4:x,d4:U,l3:V}=R;N?n.push(u):x?l.push(u):(V&&U&&b.push(u),U&&r.push(u)),Y=et(R)}A.push({position:[M,C],score:P*this.attackFactor+Y*this.defenseFactor})}let v;if(t){if(s)return e.length?e:n.length?[]:o.length?o:g.length?g:a.length||c.length?a.concat(c):l.length||r.length?[]:q.length?q:d.length?d:[];if(e.length)return e;if(n.length)return n;if(o.length)return o;if(l.length)return l;if(a.length)return a;if(b.length)return b}else{if(n.length)return n;if(e.length)return e;if(l.length)return l;if(o.length)return o;if(b.length)return b;if(a.length)return a}return v=A.sort((S,u)=>u.score-S.score).map(S=>S.position),v.length<=this.genLimit?v:v.slice(0,this.genLimit)}class z{constructor(t){H(this,"genChilds",Zt);this.init({...t})}init({firstHand:t,seekDepth:s,autoPlay:e,enableStats:n,attackFactor:o,defenseFactor:l}){this.totalChessPieces=p*p,this.initNode(),this.stack=[],this.zobrist=new Vt({size:p}),this.maxPointsScore=Z(p).map(()=>Z(p,[0,0,0,0],!0)),this.minPointsScore=Z(p).map(()=>Z(p,[0,0,0,0],!0)),this.stats={},this.initStats(),this.enableStats=n!==void 0?n:!0,this.enableLog=!1,this.firstHand=t||F,this.genLimit=80,this.seekDepth=s||4,this.seekKillDepth=17,this.autoPlay=e||!1,this.attackFactor=o||1,this.defenseFactor=l||1}isWall(t,s){return t<0||t>=p||s<0||s>=p}initNode(){this.node0=Z(p,0);const t=new ArrayBuffer(4*15);this.node1=new Int32Array(t);for(let s=0;s<=14;s++)this.node1[s]=0;this.node2=[];for(let s=0;s<p*2-1;s++){let e=0;for(let n=0;n<15;n++){const o=s-n;e<<=2,this.isWall(n,o)&&(e+=3)}this.node2[s]=e}this.node3=[];for(let s=0;s<p*2-1;s++){let e=0;for(let n=0;n<15;n++){const o=14+n-s;e<<=2,this.isWall(n,o)&&(e+=3)}this.node3[s]=e}}put(t,s,e){this.zobrist.go(t,s,e===w),this.stack.push([t,s]),this.node0[t]=this.node0[t]|e<<2*(14-s),this.node1[s]=this.node1[s]|e<<2*(14-t),this.node2[t+s]=this.node2[t+s]|e<<2*(14-t),this.node3[14+t-s]=this.node3[14+t-s]|e<<2*(14-t),this.updateFourLineScore(t,s)}rollback(t=1){if(!(this.stack.length<t))for(;t-- >0;){const[s,e]=this.stack.pop();this.zobrist.go(s,e,this.getChess(s,e)===w);const n=2*(14-e);this.node0[s]=(this.node0[s]|3<<n)^3<<n;const o=2*(14-s);this.node1[e]=(this.node1[e]|3<<o)^3<<o,this.node2[s+e]=(this.node2[s+e]|3<<o)^3<<o,this.node3[14+s-e]=(this.node3[14+s-e]|3<<o)^3<<o,this.updateFourLineScore(s,e)}}maxGo(){if(this.isFinal)return;this.zobrist.resetHash(),this.initStats();let t;this.stack.length>4&&(console.time("thinking kill"),t=this.minimax(this.seekKillDepth,!0),console.timeEnd("thinking kill")),(t==null?void 0:t.score)>=f.win?console.warn("算杀成功 :)"):(console.time("thinking"),t=this.minimax(this.seekDepth),console.timeEnd("thinking"));const{i:s,j:e}=t;return this.put(s,e,w),this.logStats(),t}minGo(t,s){if(!this.isFinal)return this.isEmptyPosition(t,s)?(this.put(t,s,F),!0):!1}minRepent(){this.stack.length>=2&&this.rollback(2)}isEmptyPosition(t,s){return!this.isWall(t,s)&&this.getChess(t,s)===G}getNearPositions(t){const s=[],[n,o]=t;for(let l=-2;l<=2;l++)for(let c=-2;c<=2;c++)this.isEmptyPosition(l+n,c+o)&&s.push([l+n,c+o]);return s}getAllOptimalNextStep(){if(this.stack.length===0)return[[X,X]];if(this.stack.length===1){if(this.isEmptyPosition(X,X))return[[X,X]];const s=X+(Math.random()>.5?1:-1),e=X+(Math.random()>.5?1:-1);return[[s,e]]}let t=[];for(let s=0;s<p;s++)for(let e=0;e<p;e++)this.getChess(s,e)===G&&this.haveNeighbor(s,e)&&t.push([s,e]);return t}haveNeighbor(t,s){for(let n=-2;n<=2;n++)if(!(n+t<0||n+t>=p))for(let o=-2;o<=2;o++){if(o+s<0||o+s>=p||n===0&&o===0)continue;if(this.getChess(n+t,s+o)!==G)return!0}return!1}getChess(t,s){return this.node0[t]>>2*(14-s)&3}minimax(t,s,e=-1/0,n=1/0,o=!0){if(this.isFinal||t===0)return{score:Tt.call(this,s),depth:t};const l=this.genChilds(this.getAllOptimalNextStep(),o,s);if(!(l!=null&&l.length))return{score:0};if(o){let c=-1/0,r=l[0];for(const a of l){const[b,q]=a;this.put(b,q,w),this.enableStats&&this.stats.abCut.eva++;let A=this.zobrist.get();if(A===void 0?(A=this.minimax(t-1,s,e,n,!o).score,this.zobrist.set(A),this.enableStats&&this.stats.zobrist.miss++):this.enableStats&&this.stats.zobrist.hit++,this.rollback(),A>c&&(c=A,r=a),e=Math.max(e,c),n<=e){this.enableStats&&this.stats.abCut.cut++;break}}const[d,g]=r;return{score:c,i:d,j:g}}else{let c=1/0,r=l[0];for(const a of l){const[b,q]=a;this.put(b,q,F),this.enableStats&&this.stats.abCut.eva++;let A=this.zobrist.get();if(A===void 0?(A=this.minimax(t-1,s,e,n,!o).score,this.zobrist.set(A),this.enableStats&&this.stats.zobrist.miss++):this.enableStats&&this.stats.zobrist.hit++,this.rollback(),A<c&&(c=A,r=a),n=Math.min(n,c),n<=e){this.enableStats&&this.stats.abCut.cut++;break}}const[d,g]=r;return{score:c,i:d,j:g}}}getChessInFourDirection(t,s,e){let n=[],o=[],l=[],c=[];if(e===void 0||e===0){const r=this.node0[t],d=s>=4?r>>2*(18-s)&3:3,g=s>=3?r>>2*(17-s)&3:3,a=s>=2?r>>2*(16-s)&3:3,b=s>=1?r>>2*(15-s)&3:3,q=r>>2*(14-s)&3,A=s<=13?r>>2*(13-s)&3:3,v=s<=12?r>>2*(12-s)&3:3,S=s<=11?r>>2*(11-s)&3:3,u=s<=10?r>>2*(10-s)&3:3;if(n=[d,g,a,b,q,A,v,S,u],e===0)return n}if(e===void 0||e===1){const r=this.node1[s],d=t>=4?r>>2*(18-t)&3:3,g=t>=3?r>>2*(17-t)&3:3,a=t>=2?r>>2*(16-t)&3:3,b=t>=1?r>>2*(15-t)&3:3,q=r>>2*(14-t)&3,A=t<=13?r>>2*(13-t)&3:3,v=t<=12?r>>2*(12-t)&3:3,S=t<=11?r>>2*(11-t)&3:3,u=t<=10?r>>2*(10-t)&3:3;if(o=[d,g,a,b,q,A,v,S,u],e===1)return o}if(e===void 0||e===2){const r=this.node2[t+s],d=t>=4?r>>2*(18-t)&3:3,g=t>=3?r>>2*(17-t)&3:3,a=t>=2?r>>2*(16-t)&3:3,b=t>=1?r>>2*(15-t)&3:3,q=r>>2*(14-t)&3,A=t<=13?r>>2*(13-t)&3:3,v=t<=12?r>>2*(12-t)&3:3,S=t<=11?r>>2*(11-t)&3:3,u=t<=10?r>>2*(10-t)&3:3;if(l=[d,g,a,b,q,A,v,S,u],e===2)return l}if(e===void 0||e===3){const r=this.node3[14+t-s],d=t>=4?r>>2*(18-t)&3:3,g=t>=3?r>>2*(17-t)&3:3,a=t>=2?r>>2*(16-t)&3:3,b=t>=1?r>>2*(15-t)&3:3,q=r>>2*(14-t)&3,A=t<=13?r>>2*(13-t)&3:3,v=t<=12?r>>2*(12-t)&3:3,S=t<=11?r>>2*(11-t)&3:3,u=t<=10?r>>2*(10-t)&3:3;if(c=[d,g,a,b,q,A,v,S,u],e===3)return c}return[n,o,l,c]}getPositionsInFourDirection(t,s){let e=[],n=[],o=[],l=[];const c=t-4>0?t-4:0,r=t+4<p-1?t+4:p-1,d=s-4>0?s-4:0,g=s+4<p-1?s+4:p-1;for(let a=d;a<=g;a++)e.push([t,a]);for(let a=c;a<=r;a++)n.push([a,s]);for(let a=4;a>0;a--)t-a>=c&&s+a<=g&&o.push([t-a,s+a]);o.push([t,s]);for(let a=1;a<=4;a++)t+a<=r&&s-a>=d&&o.push([t+a,s-a]);for(let a=4;a>0;a--)t-a>=c&&s-a>=d&&l.push([t-a,s-a]);l.push([t,s]);for(let a=1;a<=4;a++)t+a<=r&&s+a<=g&&l.push([t+a,s+a]);return[e,n,o,l]}updateFourLineScore(t,s){const e=this.getPositionsInFourDirection(t,s);for(let n=0;n<4;n++){const o=e[n];for(let l=0;l<o.length;l++){const c=o[l];this.updatePointScore(c,n)}}}updatePointScore(t,s){const[e,n]=t;this.getChess(e,n)!==G?(this.maxPointsScore[e][n]=[0,0,0,0],this.minPointsScore[e][n]=[0,0,0,0]):(this.maxPointsScore[e][n][s]=this.evaPoint(e,n,w,s),this.minPointsScore[e][n][s]=this.evaPoint(e,n,F,s))}evaPoint(t,s,e,n){const o=this.getChessInFourDirection(t,s,n),r=kt(e===w?w:F,e===w?F:w,tt);let d=0;const g=r(o),a=B[g];return d+=a||0,d}saveStack(){console.log(JSON.stringify(this.stack))}restoreStack(t){const s=this.firstHand,e=s===w?F:w;this.rollback(this.stack.length);for(let n=0;n<t.length;n++){const[o,l]=t[n];this.put(o,l,n&1?e:s)}}test(t){console.log(Function(t).call(this))}get winner(){if(this.stack.length<7)return null;const[t,s]=this.stack[this.stack.length-1],e=this.getChess(t,s),n=this.getChessInFourDirection(t,s);for(let o=0;o<4;o++){let l=0;const c=n[o];for(let r=0;r<c.length;r++)if(c[r]===e?l++:l=0,l===5)return e}return null}get winnerPositions(){if(!this.winner)return null;const[t,s]=this.stack[this.stack.length-1],e=this.getChess(t,s),n=this.getPositionsInFourDirection(t,s);for(let o=0;o<4;o++){const l=n[o];let c=0,r=[];for(let d=0;d<l.length;d++){const[g,a]=l[d];if(this.getChess(g,a)===e?(c++,r.push([g,a])):(c=0,r=[]),c===5)return r}}return null}get isFinal(){return!!this.winner||this.isBoardFull}get isBoardFull(){return this.stack.length===this.totalChessPieces}get lastChessPosition(){return this.stack.length?this.stack[this.stack.length-1]:null}get isDraw(){return this.isBoardFull&&!this.winner}get node(){return this.node0.map(t=>{let s=[];for(let e=0;e<p;e++)s.push((t&3<<2*e)>>2*e);return s.reverse()})}printNode(){console.log(this.node0.map(t=>t.toString(2))),console.log(this.node1.map(t=>t.toString(2))),console.log(this.node2.map(t=>t.toString(2))),console.log(this.node3.map(t=>t.toString(2)))}initStats(){this.stats={abCut:{all:this.genLimit**this.seekDepth,eva:0,cut:0,toString(){const{all:t,eva:s,cut:e}=this.stats.abCut,n=t-s;return`AB剪枝 最大节点总数:${t} 理论最少评估${t**.5>>0} 实际评估:${s} 剪去:${e}/${n}`}},zobrist:{miss:0,hit:0,toString(){const{hit:t,miss:s}=this.stats.zobrist;return`zobrist 评估节点数:${this.stats.abCut.eva} hit:${t} miss:${s}`}}}}logStats(){this.enableStats&&Object.keys(this.stats).forEach(t=>{console.log(this.stats[t].toString.call(this))})}}H(z,"MAX",w),H(z,"MIN",F),H(z,"EMPTY",G),H(z,"WALL",tt);const ut=()=>m("div",{className:"num",children:K(p).map(i=>m("div",{className:"item",children:i},i))});const ft=()=>m("div",{className:"abc",children:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O"].map((i,t)=>m("div",{className:"item",children:t},i))}),Yt=()=>{const[i,t]=T.useState(0);return T.useEffect(()=>{const s=setInterval(()=>{t(e=>e+.2)},200);return()=>clearInterval(s)},[]),m("div",{className:"",children:i.toFixed(1)})};function At(){return new Worker("/gobang/dist/assets/worker-9f272b46.js")}const Xt="data:audio/mpeg;base64,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",Ot="/gobang/dist/assets/win-716cbc65.mp3",Gt="/gobang/dist/assets/fail-c60229d9.mp3",Ht="/gobang/dist/assets/draw-304f12b1.mp3",Kt={fall:Xt,win:Ot,fail:Gt,draw:Ht},Jt=({musics:i,onEnded:t})=>m(_,{children:i.map(s=>m("video",{src:Kt[s.value],onEnded:()=>t(s.id),autoPlay:!0,hidden:!0},s.id))});let E=new z,Q=new At;window.test=i=>Q.postMessage({type:"test",data:i});const $t=({position:i,value:t,onClick:s,isLastChess:e,isMarkPoint:n,isWinnerPoint:o})=>{const l=E.stack.findIndex(c=>c[0]===i[0]&&c[1]===i[1]);return W("button",{className:`square ${e&&"lastChess"}`,onClick:s,children:[t!==z.EMPTY&&m("div",{className:["chess",t===E.firstHand?"black":"white",o?"pulse":""].join(" "),children:l+1||null}),n&&m("div",{className:"markPoint"})]})},It=({squares:i,onClick:t})=>{const s=E.lastChessPosition,e=E.winner,n=e?E.winnerPositions:null;return W("div",{className:"boardCenter",children:[m("div",{className:"rowLines",children:K(p).map(o=>m("div",{className:"item"},o))}),m("div",{className:"colLines",children:K(p).map(o=>m("div",{className:"item"},o))}),m("div",{className:"chesses",children:K(p).map(o=>m("div",{className:"boardRow",children:K(p).map(l=>m($t,{position:[o,l],value:i[o][l],isLastChess:s&&s[0]===o&&s[1]===l,isWinnerPoint:n&&n.some(([c,r])=>c===o&&r===l),isMarkPoint:o===3&&l===3||o===3&&l===11||o===7&&l===7||o===11&&l===3||o===11&&l===11,onClick:()=>t(o,l)},l))},o))}),W("div",{className:"gameoverTip",children:[E.isDraw&&m("div",{className:"tip",children:"和棋~"}),e&&m("div",{className:"tip",children:e===E.firstHand?"黑方胜":"白方胜"})]})]})},_t=()=>{const[i,t]=T.useState(!1),[s,e]=T.useReducer(u=>u+1,0),[n,o]=T.useState(!1),[l,c]=T.useState(!1),[r,d]=T.useReducer((u,M)=>{const{type:C,value:P,id:Y}=M;return C==="add"?[...u,{id:+new Date+Math.random(),value:P}]:C==="remove"?u.filter(y=>y.id!==Y):[]},[]),g=E.isFinal,a=(u,M)=>{if(!i)return console.log({start:i});if(g)return console.log({isFinal:g});if(n)return console.log({thinking:n});if(l)return console.log({autoPlay:l});Q.postMessage({type:"minGo",data:[u,M]})},b=()=>{o(!0),Q.postMessage({type:"maxGo"})},q=()=>{Q.terminate(),Q=new At,Q.postMessage({type:"init",data:{}}),t(!1),c(!1)},A=(u,M)=>{t(!0),c(M),Q.postMessage({type:"init",data:{firstHand:u,autoPlay:M,seekDepth:4}})},v=()=>{c(!0),Q.postMessage({type:"init",data:{firstHand:z.MAX,autoPlay:!0,seekDepth:4}})},S=()=>{Q.postMessage({type:"minRepent"})};return T.useEffect(()=>{Q.onmessage=u=>{const{type:M,gobang:C,data:P}=u.data;switch(E=JSON.parse(C),M){case"init":E.firstHand===z.MAX&&!E.autoPlay?b():e();break;case"minGo":P&&(d({type:"add",value:"fall"}),b());break;case"maxGo":d({type:"add",value:"fall"}),o(!1);break;case"autoPlay":d({type:"add",value:"fall"});break;default:e();break}}},[Q]),T.useEffect(()=>{E.isDraw&&d({type:"add",value:"draw"}),E.winner&&d({type:"add",value:E.winner===z.MAX?"fail":"win"})},[E.winner,E.isDraw]),W("div",{className:"game",children:[m(Jt,{musics:r,onEnded:u=>d({type:"remove",value:u})}),W("div",{className:"gameInfo",children:[m(Yt,{}),m("div",{className:""})]}),W("div",{className:"gameBoard",children:[m(ut,{}),W("div",{className:"center",children:[m(ft,{}),m(It,{squares:E.node,onClick:qt(a,20)}),m(ft,{})]}),m(ut,{})]}),W("div",{className:"opbtns",children:[l&&m("button",{onClick:q,children:"开始游戏"}),!l&&!i&&W(_,{children:[m("button",{onClick:()=>A(z.MAX),children:"电脑先手"}),m("button",{onClick:()=>A(z.MIN),children:"玩家先手"}),m("button",{onClick:v,children:"电脑vs电脑"})]}),i&&W(_,{children:[m("button",{onClick:q,children:"重来"}),m("button",{onClick:S,children:"悔棋"})]})]}),W("div",{className:"game-info",children:[E.winner&&m("div",{children:E.winner===z.MAX?"少侠请努力":"干得漂亮"}),m("ol",{})]})]})},ts=_t;pt.createRoot(document.getElementById("root")).render(m(ts,{}));
