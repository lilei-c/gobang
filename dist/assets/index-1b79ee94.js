var X=Object.defineProperty;var $=(t,s,e)=>s in t?X(t,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[s]=e;var E=(t,s,e)=>($(t,typeof s!="symbol"?s+"":s,e),e);import{j as jsxRuntimeExports,r as random,a as reactExports,c as client}from"./vendor-cd7d93c1.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function e(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerpolicy&&(n.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?n.credentials="include":i.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(i){if(i.ep)return;i.ep=!0;const n=e(i);fetch(i.href,n)}})();const jsx=jsxRuntimeExports.jsx,jsxs=jsxRuntimeExports.jsxs,EMPTY=0,MAX=1,MIN=2,WALL=3,boardLength=15,boardCenter=boardLength/2>>0,arrayN=(t,s=null)=>Array(t).fill(s),debounce=(t,s=20)=>{let e=+new Date;return(...o)=>{+new Date-e>s&&t(...o),e=+new Date}},range=t=>s=>Array(s-t).fill(null).map((e,o)=>t+o),range0=range(0),chessModeBit={l1:2**0,d2:2**3,l2:2**6,l2x2:2**7,d3:2**9,l3:2**12,d4:2**14,l4:2**16,l5:2**18},getPointMode=t=>({l1:t&7,d2:(t&56)>>3,l2:(t&960)>>6,d3:(t&7680)>>9,l3:(t&12288)>>12,d4:(t&49152)>>14,l4:(t&196608)>>16,l5:(t&786432)>>18}),Score={l1:10,d2:10,d3:200,l2:150,l2x2:300,l3:200,d4:2e3,l4:5e3,l5:1e4,win:1e5},calcEvaPointScore=t=>{const{l5:s,l4:e,d4:o,l3:i,d3:n,l2:r,d2:l,l1:d}=t;let h=0;return s&&(h+=Score.l5*s),e&&(h+=Score.l4*e),o&&(h+=Score.d4*o),i&&(h+=Score.l3*i),n&&(h+=Score.d3*n),r&&(h+=Score.l2*r),l&&(h+=Score.d2*l),d&&(h+=Score.l1*d),h};console.warn("todo: 测试 countLine 是否正确");const countLine=(t,s,e)=>o=>{let i=1;for(let n=0;n<o.length;n++){const r=o[n];if(n<4)i<<=1,r===t?i+=1:(r===s||r===e)&&(i=1);else if(n===4)i<<=1,i+=1;else{if(r===s||r===e)break;i<<=1,r===t&&(i+=1)}}return i},generateAllModes=t=>{let s=[],e=2**(t+1);for(;e-- >0;)s.push("0b"+e.toString(2));return s},allModes=generateAllModes(11),isLive1=t=>/010/.test(t)&&t.length>5,isDead2=t=>/10{0,1}1/.test(t)&&t.length>=5,isLive2=t=>[/000110/,/001100/,/011000/,/001010/,/010100/].some(s=>s.test(t)),isLive2x2=t=>/0101010/.test(t),isDead3=t=>[/111/,/1011/,/1101/,/11001/,/10011/,/10101/].some(s=>s.test(t))&&t.length>=5,isLive3=t=>[/010110/,/011010/,/01110/,/1010101/].some(s=>s.test(t)),isDead4=t=>[/11110/,/01111/,/11011/,/11101/,/10111/].some(s=>s.test(t)),isLive4=t=>[/011110/,/1011101/,/11011011/,/111010111/].some(s=>s.test(t)),is5=t=>/1{5}/.test(t),stat={};allModes.forEach(t=>stat[t]=null);const serialPointMode=[],{l5:l5$1,l4:l4$1,d4:d4$1,l3:l3$1,d3:d3$1,l2:l2$1,l2x2:l2x2$1,d2:d2$1,l1:l1$1}=chessModeBit;allModes.forEach(t=>isLive1(t.slice(3))&&(stat[t]="l1")&&(serialPointMode[+t]=l1$1));allModes.forEach(t=>isDead2(t.slice(3))&&(stat[t]="d2")&&(serialPointMode[+t]=d2$1));allModes.forEach(t=>isLive2(t.slice(3))&&(stat[t]="l2")&&(serialPointMode[+t]=l2$1));allModes.forEach(t=>isDead3(t.slice(3))&&(stat[t]="d3")&&(serialPointMode[+t]=d3$1));allModes.forEach(t=>isLive2x2(t.slice(3))&&(stat[t]="l2x2")&&(serialPointMode[+t]=l2x2$1));allModes.forEach(t=>isLive3(t.slice(3))&&(stat[t]="l3")&&(serialPointMode[+t]=l3$1));allModes.forEach(t=>isDead4(t.slice(3))&&(stat[t]="d4")&&(serialPointMode[+t]=d4$1));allModes.forEach(t=>isLive4(t.slice(3))&&(stat[t]="l4")&&(serialPointMode[+t]=l4$1));allModes.forEach(t=>is5(t.slice(3))&&(stat[t]="l5")&&(serialPointMode[+t]=l5$1));console.log("未构成棋型的组合, 这一部分已经验证",Object.keys(stat).filter(t=>!stat[t]).map(t=>t.slice(3)));console.warn("todo: 验证以下棋型是否正确");Object.keys(Score).forEach(t=>{console.log(t,Object.keys(stat).filter(s=>stat[s]===t).map(s=>s.slice(3)))});console.log({allModes,serialPointMode});class Zobrist{constructor({size:s}){this.max=arrayN(s).map(o=>arrayN(s).map(()=>random.int(0,1073741824))),this.min=arrayN(s).map(o=>arrayN(s).map(()=>random.int(0,1073741824))),this.code=random.int(0,1073741824),this.hash={}}go(s,e,o){this.code^=o?this.max[s][e]:this.min[s][e]}get(){return this.hash[this.code]}set(s){this.hash[this.code]=s}resetHash(){this.hash={}}}const{l1,d2,l2,l2x2,d3,l3,d4,l4,l5}=chessModeBit;function evaluate(t,s){const e=this.winner;if(e===MAX)return Score.win;if(e===MIN)return-Score.win;if(t)return 0;let o=0,i=0,n=0,r=0,l=0,d=0,h=0,a=0,p=0,g=0,u=0,f=0,m=0,b=0,k=0,v=0;const y=(c,A)=>{if(A<34)return;const N=serialPointMode[A];if(N)if(c===MAX)switch(N){case l1:return a++;case d2:return h++;case l2:return d++;case l2x2:return d+=2;case d3:return l++;case l3:return r++;case d4:return n++;case l4:return i++;case l5:return o++;default:return console.error("error")}else switch(N){case l1:return v++;case d2:return k++;case l2:return b++;case l2x2:return b+=2;case d3:return m++;case l3:return f++;case d4:return u++;case l4:return g++;case l5:return p++;default:return console.error("error")}},C=(c,A,N)=>{let x=1,w=0,j=!1;for(let D=0;D<15;D++){const F=N&3;if(N>>=2,F===A||F===WALL){y(c,x),x=1,j=!0;continue}else if(F===EMPTY)if(w===0)w++,x<<=1;else{x<<=1,(N&12)===EMPTY&&D!==14&&(x<<=1),y(c,x),x=4,(N&12)===EMPTY&&D!==14&&(x<<=1),w=0,j=!0;continue}else w=0,j=!1,x<<=1,x+=1}j||y(c,x)};for(let c=0;c<this.node0.length;c++)C(MAX,MIN,this.node0[c]);for(let c=0;c<this.node1.length;c++)C(MAX,MIN,this.node1[c]);for(let c=0;c<this.node2.length;c++)C(MAX,MIN,this.node2[c]);for(let c=0;c<this.node3.length;c++)C(MAX,MIN,this.node3[c]);for(let c=0;c<this.node0.length;c++)C(MIN,MAX,this.node0[c]);for(let c=0;c<this.node1.length;c++)C(MIN,MAX,this.node1[c]);for(let c=0;c<this.node2.length;c++)C(MIN,MAX,this.node2[c]);for(let c=0;c<this.node3.length;c++)C(MIN,MAX,this.node3[c]);s&&(console.log({maxL1:a,maxD2:h,maxL2:d,maxD3:l,maxL3:r,maxD4:n,maxL4:i,maxL5:o}),console.log({minL1:v,minD2:k,minL2:b,minD3:m,minL3:f,minD4:u,minL4:g,minL5:p}));let L=0,P=0;if((this.seekDepth&1)===0){if(i||n)return Score.l5;if(g||u>2||f>2||f&u)return-Score.l5;r&&!g&&!u&&(L+=Score.l4)}else{if(g||u)return-Score.l5;if(i)return Score.l5;if(n>2||r>2||r&n)return-Score.l5;f&&!i&&!n&&(P+=Score.l4)}return L=Score.l5*o+Score.l4*i+Score.d4*n+Score.l3*r+Score.d3*l+Score.l2*d+Score.d2*h+Score.l1*h,P=Score.l5*p+Score.l4*g+Score.d4*u+Score.l3*f+Score.d3*m+Score.l2*b+Score.d2*k+Score.l1*k,L*this.attackFactor-P*this.defenseFactor}function genChilds(t,s,e){let o=[],i=[],n=[],r=[],l=[],d=[],h=[],a=[],p=[],g=[],u=[];for(let m=0;m<t.length;m++){const b=t[m],[k,v]=b;let y=0,C=0,L=getPointMode(this.maxPointsScore[k][v][0]);{const M=getPointMode(this.maxPointsScore[k][v][1]),S=getPointMode(this.maxPointsScore[k][v][2]),c=getPointMode(this.maxPointsScore[k][v][3]);L.l5+=M.l5+S.l5+c.l5,L.l4+=M.l4+S.l4+c.l4,L.d4+=M.d4+S.d4+c.d4,L.l3+=M.l3+S.l3+c.l3,L.d3+=M.d3+S.d3+c.d3,L.l2+=M.l2+S.l2+c.l2,L.d2+=M.d2+S.d2+c.d2,L.l1+=M.l1+S.l1+c.l1;const{l5:A,l4:N,d4:x,l3:w}=L;A?o.push(b):N?n.push(b):(w&&x&&p.push(b),w>1&&a.push(b),w&&h.push(b),x&&l.push(b)),y=calcEvaPointScore(L)}let P=getPointMode(this.minPointsScore[k][v][0]);{const M=getPointMode(this.minPointsScore[k][v][1]),S=getPointMode(this.minPointsScore[k][v][2]),c=getPointMode(this.minPointsScore[k][v][3]);P.l5+=M.l5+S.l5+c.l5,P.l4+=M.l4+S.l4+c.l4,P.d4+=M.d4+S.d4+c.d4,P.l3+=M.l3+S.l3+c.l3,P.d3+=M.d3+S.d3+c.d3,P.l2+=M.l2+S.l2+c.l2,P.d2+=M.d2+S.d2+c.d2,P.l1+=M.l1+S.l1+c.l1;const{l5:A,l4:N,d4:x,l3:w}=P;A?i.push(b):N?r.push(b):(w&&x&&g.push(b),x&&d.push(b)),C=calcEvaPointScore(P)}u.push({position:[k,v],score:y*this.attackFactor+C*this.defenseFactor})}let f;if(s){if(e)return o.length?o:i.length?[]:n.length?n:p.length||l.length?p.concat(l):r.length||d.length?[]:a.length?a:h.length?h:[];if(o.length)return o;if(i.length)return i;if(n.length)return n;if(r.length)return r;if(p.length)return p;if(g.length)return g}else{if(i.length)return i;if(o.length)return o;if(r.length)return r;if(n.length)return n;if(g.length)return g;if(p.length)return p}return f=u.sort((m,b)=>b.score-m.score).map(m=>m.position),f.length<=this.genLimit?f:f.slice(0,this.genLimit)}class Gobang{constructor(t){E(this,"genChilds",genChilds);this.init({...t})}init({firstHand:t,seekDepth:s,autoPlay:e,enableStats:o,attackFactor:i,defenseFactor:n}){this.totalChessPieces=boardLength*boardLength,this.initNode(),this.stack=[],this.zobrist=new Zobrist({size:boardLength}),this.maxPointsScore=arrayN(boardLength).map(r=>arrayN(boardLength,[0,0,0,0])),this.minPointsScore=arrayN(boardLength).map(r=>arrayN(boardLength,[0,0,0,0])),this.stats={},this.enableStats=o!==void 0?o:!0,this.enableLog=!1,this.firstHand=t||MIN,this.genLimit=20,this.seekDepth=s||6,this.seekKillDepth=17,this.autoPlay=e,this.attackFactor=i||1,this.defenseFactor=n||2}isWall(t,s){return t<0||t>=boardLength||s<0||s>=boardLength}initNode(){this.node0=arrayN(boardLength,0);const t=new ArrayBuffer(4*15);this.node1=new Int32Array(t);for(let s=0;s<=14;s++)this.node1[s]=0;this.node2=[];for(let s=0;s<boardLength*2-1;s++){let e=0;for(let o=0;o<15;o++){const i=s-o;e<<=2,this.isWall(o,i)&&(e+=3)}this.node2[s]=e}this.node3=[];for(let s=0;s<boardLength*2-1;s++){let e=0;for(let o=0;o<15;o++){const i=14+o-s;e<<=2,this.isWall(o,i)&&(e+=3)}this.node3[s]=e}}put(t,s,e){this.zobrist.go(t,s,e===MAX),this.stack.push([t,s]),this.node0[t]=this.node0[t]|e<<2*(14-s),this.node1[s]=this.node1[s]|e<<2*(14-t),this.node2[t+s]=this.node2[t+s]|e<<2*(14-t),this.node3[14+t-s]=this.node3[14+t-s]|e<<2*(14-t),this.updateFourLineScore(t,s)}rollback(t=1){if(!(this.stack.length<t))for(;t-- >0;){const[s,e]=this.stack.pop();this.zobrist.go(s,e,this.getChess(s,e)===MAX);const o=2*(14-e);this.node0[s]=(this.node0[s]|3<<o)^3<<o;const i=2*(14-s);this.node1[e]=(this.node1[e]|3<<i)^3<<i,this.node2[s+e]=(this.node2[s+e]|3<<i)^3<<i,this.node3[14+s-e]=(this.node3[14+s-e]|3<<i)^3<<i,this.updateFourLineScore(s,e)}}maxGo(){if(this.isFinal)return;this.zobrist.resetHash(),this.initStats();let t;this.stack.length>4&&(console.time("thinking kill"),t=this.minimax(this.seekKillDepth,!0),console.timeEnd("thinking kill")),(t==null?void 0:t.score)>=Score.win?console.warn("算杀成功 :)"):(console.time("thinking"),t=this.minimax(this.seekDepth),console.timeEnd("thinking")),console.log({score:t});const{i:s,j:e}=t;return this.put(s,e,MAX),this.logStats(),t}minGo(t,s){if(!this.isFinal)return this.isEmptyPosition(t,s)?(this.put(t,s,MIN),!0):!1}minRepent(){this.stack.length>=2&&this.rollback(2)}isEmptyPosition(t,s){return!this.isWall(t,s)&&this.getChess(t,s)===EMPTY}getNearPositions(t){const s=[],[o,i]=t;for(let n=-2;n<=2;n++)for(let r=-2;r<=2;r++)this.isEmptyPosition(n+o,r+i)&&s.push([n+o,r+i]);return s}getAllOptimalNextStep(){if(this.stack.length===0)return[[boardCenter,boardCenter]];if(this.stack.length===1){if(this.isEmptyPosition(boardCenter,boardCenter))return[[boardCenter,boardCenter]];const s=boardCenter+(Math.random()>.5?1:-1),e=boardCenter+(Math.random()>.5?1:-1);return[[s,e]]}let t=[];for(let s=0;s<boardLength;s++)for(let e=0;e<boardLength;e++)this.getChess(s,e)===EMPTY&&this.haveNeighbor(s,e)&&t.push([s,e]);return t}haveNeighbor(t,s){for(let o=-2;o<=2;o++)if(!(o+t<0||o+t>=boardLength))for(let i=-2;i<=2;i++){if(i+s<0||i+s>=boardLength||o===0&&i===0)continue;if(this.getChess(o+t,s+i)!==EMPTY)return!0}return!1}getChess(t,s){return this.node0[t]>>2*(14-s)&3}minimax(t,s,e=-1/0,o=1/0,i=!0){if(this.isFinal||t===0)return{score:evaluate.call(this,s),depth:t};const n=this.genChilds(this.getAllOptimalNextStep(),i,s);if(!(n!=null&&n.length))return{score:0};if(i){let r=-1/0,l=n[0];for(const a of n){const[p,g]=a;this.put(p,g,MAX),this.enableStats&&this.stats.abCut.eva++;let u=this.zobrist.get();if(u===void 0?(u=this.minimax(t-1,s,e,o,!i).score,this.zobrist.set(u),this.enableStats&&this.stats.zobrist.miss++):this.enableStats&&this.stats.zobrist.hit++,this.rollback(),u>r&&(r=u,l=a),e=Math.max(e,r),o<=e){this.enableStats&&this.stats.abCut.cut++;break}}const[d,h]=l;return{score:r,i:d,j:h}}else{let r=1/0,l=n[0];for(const a of n){const[p,g]=a;this.put(p,g,MIN),this.enableStats&&this.stats.abCut.eva++;let u=this.zobrist.get();if(u===void 0?(u=this.minimax(t-1,s,e,o,!i).score,this.zobrist.set(u),this.enableStats&&this.stats.zobrist.miss++):this.enableStats&&this.stats.zobrist.hit++,this.rollback(),u<r&&(r=u,l=a),o=Math.min(o,r),o<=e){this.enableStats&&this.stats.abCut.cut++;break}}const[d,h]=l;return{score:r,i:d,j:h}}}getChessInFourDirection(t,s,e){let o=[],i=[],n=[],r=[];if(e===void 0||e===0){const l=this.node0[t],d=s>=4?l>>2*(18-s)&3:3,h=s>=3?l>>2*(17-s)&3:3,a=s>=2?l>>2*(16-s)&3:3,p=s>=1?l>>2*(15-s)&3:3,g=l>>2*(14-s)&3,u=s<=13?l>>2*(13-s)&3:3,f=s<=12?l>>2*(12-s)&3:3,m=s<=11?l>>2*(11-s)&3:3,b=s<=10?l>>2*(10-s)&3:3;if(o=[d,h,a,p,g,u,f,m,b],e===0)return o}if(e===void 0||e===1){const l=this.node1[s],d=t>=4?l>>2*(18-t)&3:3,h=t>=3?l>>2*(17-t)&3:3,a=t>=2?l>>2*(16-t)&3:3,p=t>=1?l>>2*(15-t)&3:3,g=l>>2*(14-t)&3,u=t<=13?l>>2*(13-t)&3:3,f=t<=12?l>>2*(12-t)&3:3,m=t<=11?l>>2*(11-t)&3:3,b=t<=10?l>>2*(10-t)&3:3;if(i=[d,h,a,p,g,u,f,m,b],e===1)return i}if(e===void 0||e===2){const l=this.node2[t+s],d=t>=4?l>>2*(18-t)&3:3,h=t>=3?l>>2*(17-t)&3:3,a=t>=2?l>>2*(16-t)&3:3,p=t>=1?l>>2*(15-t)&3:3,g=l>>2*(14-t)&3,u=t<=13?l>>2*(13-t)&3:3,f=t<=12?l>>2*(12-t)&3:3,m=t<=11?l>>2*(11-t)&3:3,b=t<=10?l>>2*(10-t)&3:3;if(n=[d,h,a,p,g,u,f,m,b],e===2)return n}if(e===void 0||e===3){const l=this.node3[14+t-s],d=t>=4?l>>2*(18-t)&3:3,h=t>=3?l>>2*(17-t)&3:3,a=t>=2?l>>2*(16-t)&3:3,p=t>=1?l>>2*(15-t)&3:3,g=l>>2*(14-t)&3,u=t<=13?l>>2*(13-t)&3:3,f=t<=12?l>>2*(12-t)&3:3,m=t<=11?l>>2*(11-t)&3:3,b=t<=10?l>>2*(10-t)&3:3;if(r=[d,h,a,p,g,u,f,m,b],e===3)return r}return[o,i,n,r]}getPositionsInFourDirection(t,s){let e=[],o=[],i=[],n=[];const r=t-4>0?t-4:0,l=t+4<boardLength-1?t+4:boardLength-1,d=s-4>0?s-4:0,h=s+4<boardLength-1?s+4:boardLength-1;for(let a=d;a<=h;a++)e.push([t,a]);for(let a=r;a<=l;a++)o.push([a,s]);for(let a=4;a>0;a--)t-a>=r&&s+a<=h&&i.push([t-a,s+a]);i.push([t,s]);for(let a=1;a<=4;a++)t+a<=l&&s-a>=d&&i.push([t+a,s-a]);for(let a=4;a>0;a--)t-a>=r&&s-a>=d&&n.push([t-a,s-a]);n.push([t,s]);for(let a=1;a<=4;a++)t+a<=l&&s+a<=h&&n.push([t+a,s+a]);return[e,o,i,n]}updateFourLineScore(t,s){const e=this.getPositionsInFourDirection(t,s);for(let o=0;o<4;o++){const i=e[o];for(let n=0;n<i.length;n++){const r=i[n];this.updatePointScore(r,o)}}}updatePointScore(t,s){const[e,o]=t;this.getChess(e,o)!==EMPTY?(this.maxPointsScore[e][o]=[0,0,0,0],this.minPointsScore[e][o]=[0,0,0,0]):(this.maxPointsScore[e][o][s]=this.evaPoint(e,o,MAX,s),this.minPointsScore[e][o][s]=this.evaPoint(e,o,MIN,s))}evaPoint(t,s,e,o){const i=this.getChessInFourDirection(t,s,o),l=countLine(e===MAX?MAX:MIN,e===MAX?MIN:MAX,WALL);let d=0;const h=l(i),a=serialPointMode[h];return d+=a||0,d}saveStack(){console.log(JSON.stringify(this.stack))}restoreStack(t){let s=this.firstHand,e=s===MAX?MIN:MAX;for(var o=0;o<t.length;o++){const[i,n]=t[o];this.put(i,n,o&1?e:s)}}test(data){console.log(eval(data))}get winner(){if(this.stack.length<7)return null;const[t,s]=this.stack[this.stack.length-1],e=this.getChess(t,s),o=this.getChessInFourDirection(t,s);for(let i=0;i<4;i++){let n=0;const r=o[i];for(let l=0;l<r.length;l++)if(r[l]===e?n++:n=0,n===5)return e}return null}get winnerPositions(){if(!this.winner)return null;const[t,s]=this.stack[this.stack.length-1],e=this.getChess(t,s),o=this.getPositionsInFourDirection(t,s);for(let i=0;i<4;i++){const n=o[i];let r=0,l=[];for(let d=0;d<n.length;d++){const[h,a]=n[d];if(this.getChess(h,a)===e?(r++,l.push([h,a])):(r=0,l=[]),r===5)return l}}return null}get isFinal(){return!!this.winner||this.isBoardFull}get isBoardFull(){return this.stack.length===this.totalChessPieces}get lastChessPosition(){return this.stack.length?this.stack[this.stack.length-1]:null}get isDraw(){return this.isBoardFull&&!this.winner}get node(){return this.node0.map(t=>{let s=[];for(let e=0;e<boardLength;e++)s.push((t&3<<2*e)>>2*e);return s.reverse()})}printNode(){console.log(this.node0.map(t=>t.toString(2))),console.log(this.node1.map(t=>t.toString(2))),console.log(this.node2.map(t=>t.toString(2))),console.log(this.node3.map(t=>t.toString(2)))}initStats(){this.stats={abCut:{all:this.genLimit**this.seekDepth,eva:0,cut:0,toString(){const{all:t,eva:s,cut:e}=this.stats.abCut,o=t-s;return`AB剪枝 最大节点总数:${t} 理论最少评估${t**.5>>0} 实际评估:${s} 剪去:${e}/${o}`}},zobrist:{miss:0,hit:0,toString(){const{hit:t,miss:s}=this.stats.zobrist;return`zobrist 评估节点数:${this.stats.abCut.eva} hit:${t} miss:${s}`}}}}logStats(){this.enableStats&&Object.keys(this.stats).forEach(t=>{console.log(this.stats[t].toString.call(this))})}}E(Gobang,"MAX",MAX),E(Gobang,"MIN",MIN),E(Gobang,"EMPTY",EMPTY),E(Gobang,"WALL",WALL);const App$1="",num="",Num=()=>jsx("div",{className:"num",children:range0(boardLength).map(t=>jsx("div",{className:"item",children:boardLength-t},t))}),abc="",ABC=()=>jsx("div",{className:"abc",children:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O"].map(t=>jsx("div",{className:"item",children:t},t))}),Time=()=>{const[t,s]=reactExports.useState(0);return reactExports.useEffect(()=>{const e=setInterval(()=>{s(o=>o+.2)},200);return()=>clearInterval(e)},[]),jsx("div",{className:"",children:t.toFixed(1)})};function WorkerWrapper(){return new Worker("/gobang/dist/assets/worker-ce3c143e.js")}let gobang=new Gobang,worker=new WorkerWrapper;window.test=t=>worker.postMessage({type:"test",data:t});const Square=({position:t,value:s,onClick:e,isLastChess:o,isMarkPoint:i,isWinnerPoint:n})=>{const r=gobang.stack.findIndex(l=>l[0]===t[0]&&l[1]===t[1]);return jsxs("button",{className:`square ${o&&"lastChess"}`,onClick:e,children:[s!==Gobang.EMPTY&&jsx("div",{className:["chess",s===gobang.firstHand?"black":"white",n?"pulse":""].join(" "),children:r+1||null}),i&&jsx("div",{className:"markPoint"})]})},Board=({squares:t,onClick:s})=>{const e=gobang.lastChessPosition,o=gobang.winner,i=o?gobang.winnerPositions:null;return jsxs("div",{className:"boardCenter",children:[jsx("div",{className:"rowLines",children:range0(boardLength).map(n=>jsx("div",{className:"item"},n))}),jsx("div",{className:"colLines",children:range0(boardLength).map(n=>jsx("div",{className:"item"},n))}),jsx("div",{className:"chesses",children:range0(boardLength).map(n=>jsx("div",{className:"boardRow",children:range0(boardLength).map(r=>jsx(Square,{position:[n,r],value:t[n][r],isLastChess:e&&e[0]===n&&e[1]===r,isWinnerPoint:i&&i.some(([l,d])=>l===n&&d===r),isMarkPoint:n===3&&r===3||n===3&&r===11||n===7&&r===7||n===11&&r===3||n===11&&r===11,onClick:()=>s(n,r)},r))},n))}),jsxs("div",{className:"gameoverTip",children:[gobang.isDraw&&jsx("div",{className:"tip",children:"和棋~"}),o&&jsx("div",{className:"tip",children:o===gobang.firstHand?"黑方胜":"白方胜"})]})]})},Game=()=>{const[t,s]=reactExports.useState(!1),[e,o]=reactExports.useReducer(f=>f+1,0),[i,n]=reactExports.useState(!1),[r,l]=reactExports.useState(!1),d=gobang.isFinal,h=(f,m)=>{if(console.log({start:t,isFinal:d,thinking:i}),!t)return console.log({start:t});if(d)return console.log({isFinal:d});if(i)return console.log({thinking:i});if(r)return console.log({autoPlay:r});worker.postMessage({type:"minGo",data:[f,m]})},a=()=>{n(!0),worker.postMessage({type:"maxGo"})},p=()=>{s(!1)},g=(f,m)=>{s(!0),l(m),worker.postMessage({type:"init",data:{firstHand:f,autoPlay:m,seekDepth:m?2:void 0}})},u=()=>{worker.postMessage({type:"minRepent"})};return reactExports.useEffect(()=>{worker.onmessage=f=>{const{type:m,gobang:b,data:k}=f.data;switch(gobang=JSON.parse(b),o(),m){case"init":gobang.firstHand===Gobang.MAX&&!gobang.autoPlay&&a();break;case"minGo":k&&a();break;case"maxGo":n(!1);break}}},[]),jsxs("div",{className:"game",children:[jsxs("div",{className:"gameInfo",children:[jsx(Time,{}),jsx("div",{className:""})]}),jsxs("div",{className:"gameBoard",children:[jsx(Num,{}),jsxs("div",{className:"center",children:[jsx(ABC,{}),jsx(Board,{squares:gobang.node,onClick:debounce(h,20)}),jsx(ABC,{})]}),jsx(Num,{})]}),jsxs("div",{className:"opbtns",children:[t&&jsx("button",{onClick:p,children:"重来"}),!t&&jsx("button",{onClick:()=>g(Gobang.MAX),children:"电脑先手"}),!t&&jsx("button",{onClick:()=>g(Gobang.MIN),children:"玩家先手"}),!t&&jsx("button",{onClick:()=>g(Gobang.MAX,!0),children:"电脑vs电脑"}),t&&jsx("button",{onClick:()=>{u()},children:"悔棋"})]}),jsxs("div",{className:"game-info",children:[gobang.winner&&jsx("div",{children:gobang.winner===Gobang.MAX?"少侠请努力":"干得漂亮"}),jsx("ol",{})]})]})},App=Game,index="";client.createRoot(document.getElementById("root")).render(jsx(App,{}));
